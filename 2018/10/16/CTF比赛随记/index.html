<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content>
  <meta name="author" content="disshu">
  <!-- Open Graph Data -->
  <meta property="og:title" content="CTF比赛随记(持续更新)">
  <meta property="og:description" content>
  <meta property="og:site_name" content="disshu">
  <meta property="og:type" content="article">
  <meta property="og:image" content="http://yoursite.com">
  
    <link rel="alternate" href="/atom.xml" title="disshu" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>disshu</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/disshu.github.io/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/disshu.github.io/css/style.dark.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/disshu.github.io//img/default-banner-dark.jpg)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">CTF比赛随记(持续更新)</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/disshu.github.io/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/disshu.github.io/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/disshu">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:15695257867@163.com">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>

<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By disshu</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2018-10-15</span>
            <span class="time">10:15:17</span>
          </span>
          
        </div>
        <!-- Tags -->
        
        <!-- Post Main Content -->
        <div class="post-content">
          <p><strong>新手区(攻防世界)</strong><br>1.X-Forwarded-For:发送的真实的ip地址<br>2.referer:返回来源地址<br>3.X-Forwarded-For:简称XFF头，它代表客户端，也就是HTTP的请求端真实的IP，只有在通过了HTTP 代理或者负载均衡服务器时才会添加该项<br>4.HTTP Referer是header的一部分，当浏览器向web服务器发送请求的时候，一般会带上Referer，告诉服务器我是从哪个页面链接过来的<br>遇到编码unicode，先用python脚本解开试试<br>5.find / -name flag.txt<br>使用find按文件名来查找语法：find / -name 文件名;<br><strong>cat(攻防世界)</strong><br>总结<br>1.如果对于正常表达式，结果无效的话，就出现了过滤<br>这时候我们就可以用fuzzing测试来判断过滤了哪些字符，常用办法就是用bp构造字典，来进行爆破<br>2.宽字节报错，其实我们在构造字典的时候放几个宽字节,有可能php或django后台的编码有问题，会报错<br>3.curl命令处理，curl命令是以file=@文件的格式上传，这道题就利用了文件包含漏洞去读取，读取的时候前面要加上@<br>4.flag一般都在对方的数据库，所以我们读取文件不知道怎么下手的时候一定要尽量找到对方的数据库文件<br>ice-05(攻防世界)<br>1.用dirsearch.py扫描目录，找到有漏洞的网站<br>2.php://filter/read=convert.base64-encode/resource=xxxxx.php(文件包含漏洞专用)<br>3./e 修正符使 preg_replace() 将 replacement 参数当作 PHP 代码(在适当的逆向引用替换完之后)。提示：要确保 replacement 构成一个合法的 PHP 代码字符串，否则 PHP 会在报告在包含 preg_replace() 的行中出现语法解析错误。</p>
<pre><code class="hljs undefined"><span class="hljs-keyword">if</span> ($_SERVER[<span class="hljs-string">'HTTP_X_FORWARDED_FOR'</span>] === <span class="hljs-string">'127.0.0.1'</span>) &#123;

    echo <span class="hljs-string">"&lt;br &gt;Welcome My Admin ! &lt;br &gt;"</span>;

    $pattern = $_GET[pat];
    $replacement = $_GET[rep];
    $subject = $_GET[<span class="hljs-function"><span class="hljs-keyword">sub</span>]</span>;

    <span class="hljs-keyword">if</span> (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) &#123;
        preg_replace($pattern, $replacement, $subject);
    &#125;<span class="hljs-keyword">else</span>&#123;
        <span class="hljs-keyword">die</span>();
    &#125;

&#125;</code></pre>

<p>payload如下<br>1.把X-Forwarded-For换成127.0.0.1<br>2.<code>?pat=/test/e&amp;rep=phpinfo()&amp;sub=just test</code><br>pat是正则匹配模式，sub是字符串。rep是替换的内容<br><strong>php之assert()</strong></p>
<p>bool assert(mixed $assertion[,string,$description])，如果assertion是字符串，他会被assert()当做php代码执行。 思路是通过可控变量file传入恶意参数，构造闭合 file_exists(),使assert()执行恶意代码。<br>‘) or phpinfo();# ——即变成file_exists(‘’) or phpinfo();# ，结果为执行phpinfo()，注意要url编码，本处为了方便阅读，以编码前显示<br>‘) or print_r(file_get_contents(‘templates/flag.php’);# ——然后在源代码里（临门一脚不要被坑了） 即最终payload:?page=’)%20or%20print_r(file_get_contents(‘templates%2fflag.php’))%3b%23<br><strong>文件泄漏</strong><br>.rar   .zip  .7z   .tar.gz   .bak    .swp   .txt   .sql</p>

        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Theme By <a target="_blank" href="https://github.com/levblanc">Levblanc.</a>
          Inspired By <a target="_blank" href="https://github.com/klugjo/hexo-theme-clean-blog">Clean Blog.</a>
        <p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/disshu.github.io/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

