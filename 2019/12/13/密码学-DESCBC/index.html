<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content>
  <meta name="author" content="disshu">
  <!-- Open Graph Data -->
  <meta property="og:title" content="密码学-DESCBC">
  <meta property="og:description" content>
  <meta property="og:site_name" content="disshu">
  <meta property="og:type" content="article">
  <meta property="og:image" content="http://yoursite.com">
  
    <link rel="alternate" href="/atom.xml" title="disshu" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>disshu</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/disshu.github.io/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/disshu.github.io/css/style.dark.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/disshu.github.io//img/cumt.png)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">密码学-DESCBC</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/disshu.github.io/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/disshu.github.io/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/disshu">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:15695257867@163.com">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>

<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By disshu</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2019-12-12</span>
            <span class="time">20:25:21</span>
          </span>
          
          <!--  Categories  -->
            <span class="categories info">Under 

<a href="/disshu.github.io/categories/技术/">技术</a>
</span>
          
        </div>
        <!-- Tags -->
        
          <div class="post-tags text-muted">
            Tags: 

<a class="tag" href="/disshu.github.io/tags/密码学/">#密码学</a>


          </div>
        
        <!-- Post Main Content -->
        <div class="post-content">
          <p>密码学实现在CBC输出模式下的DES加解密</p>
<a id="more"></a>
<p>首先给出S盒，P盒，ip置换</p>
<pre><code class="hljs undefined">IP_table = [<span class="hljs-number">58</span>, <span class="hljs-number">50</span>, <span class="hljs-number">42</span>, <span class="hljs-number">34</span>, <span class="hljs-number">26</span>, <span class="hljs-number">18</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>,
            <span class="hljs-number">60</span>, <span class="hljs-number">52</span>, <span class="hljs-number">44</span>, <span class="hljs-number">36</span>, <span class="hljs-number">28</span>, <span class="hljs-number">20</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>,
            <span class="hljs-number">62</span>, <span class="hljs-number">54</span>, <span class="hljs-number">46</span>, <span class="hljs-number">38</span>, <span class="hljs-number">30</span>, <span class="hljs-number">22</span>, <span class="hljs-number">14</span>, <span class="hljs-number">6</span>,
            <span class="hljs-number">64</span>, <span class="hljs-number">56</span>, <span class="hljs-number">48</span>, <span class="hljs-number">40</span>, <span class="hljs-number">32</span>, <span class="hljs-number">24</span>, <span class="hljs-number">16</span>, <span class="hljs-number">8</span>,
            <span class="hljs-number">57</span>, <span class="hljs-number">49</span>, <span class="hljs-number">41</span>, <span class="hljs-number">33</span>, <span class="hljs-number">25</span>, <span class="hljs-number">17</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>,
            <span class="hljs-number">59</span>, <span class="hljs-number">51</span>, <span class="hljs-number">43</span>, <span class="hljs-number">35</span>, <span class="hljs-number">27</span>, <span class="hljs-number">19</span>, <span class="hljs-number">11</span>, <span class="hljs-number">3</span>,
            <span class="hljs-number">61</span>, <span class="hljs-number">53</span>, <span class="hljs-number">45</span>, <span class="hljs-number">37</span>, <span class="hljs-number">29</span>, <span class="hljs-number">21</span>, <span class="hljs-number">13</span>, <span class="hljs-number">5</span>,
            <span class="hljs-number">63</span>, <span class="hljs-number">55</span>, <span class="hljs-number">47</span>, <span class="hljs-number">39</span>, <span class="hljs-number">31</span>, <span class="hljs-number">23</span>, <span class="hljs-number">15</span>, <span class="hljs-number">7</span>]


IP_re_table = [<span class="hljs-number">40</span>,<span class="hljs-number">8</span>, <span class="hljs-number">48</span>, <span class="hljs-number">16</span>, <span class="hljs-number">56</span>, <span class="hljs-number">24</span>, <span class="hljs-number">64</span>, <span class="hljs-number">32</span>, <span class="hljs-number">39</span>,
             <span class="hljs-number">7</span>, <span class="hljs-number">47</span>, <span class="hljs-number">15</span>, <span class="hljs-number">55</span>, <span class="hljs-number">23</span>, <span class="hljs-number">63</span>, <span class="hljs-number">31</span>, <span class="hljs-number">38</span>, <span class="hljs-number">6</span>,
             <span class="hljs-number">46</span>, <span class="hljs-number">14</span>, <span class="hljs-number">54</span>, <span class="hljs-number">22</span>, <span class="hljs-number">62</span>, <span class="hljs-number">30</span>, <span class="hljs-number">37</span>,<span class="hljs-number">5</span>, <span class="hljs-number">45</span>,
             <span class="hljs-number">13</span>, <span class="hljs-number">53</span>, <span class="hljs-number">21</span>, <span class="hljs-number">61</span>, <span class="hljs-number">29</span>, <span class="hljs-number">36</span>, <span class="hljs-number">4</span>, <span class="hljs-number">44</span>, <span class="hljs-number">12</span>,
             <span class="hljs-number">52</span>, <span class="hljs-number">20</span>, <span class="hljs-number">60</span>, <span class="hljs-number">28</span>, <span class="hljs-number">35</span>, <span class="hljs-number">3</span>, <span class="hljs-number">43</span>, <span class="hljs-number">11</span>, <span class="hljs-number">51</span>,
             <span class="hljs-number">19</span>, <span class="hljs-number">59</span>, <span class="hljs-number">27</span>, <span class="hljs-number">34</span>, <span class="hljs-number">2</span>, <span class="hljs-number">42</span>, <span class="hljs-number">10</span>, <span class="hljs-number">50</span>, <span class="hljs-number">18</span>,
             <span class="hljs-number">58</span>, <span class="hljs-number">26</span>, <span class="hljs-number">33</span>, <span class="hljs-number">1</span>, <span class="hljs-number">41</span>,<span class="hljs-number">9</span>, <span class="hljs-number">49</span>, <span class="hljs-number">17</span>, <span class="hljs-number">57</span>, <span class="hljs-number">25</span>]




E  = [<span class="hljs-number">32</span>, <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,
       <span class="hljs-number">6</span>, <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>,
      <span class="hljs-number">12</span>,<span class="hljs-number">13</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>,
      <span class="hljs-number">16</span>,<span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>,
      <span class="hljs-number">22</span>, <span class="hljs-number">23</span>, <span class="hljs-number">24</span>, <span class="hljs-number">25</span>,<span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">26</span>, <span class="hljs-number">27</span>,
      <span class="hljs-number">28</span>, <span class="hljs-number">29</span>,<span class="hljs-number">28</span>, <span class="hljs-number">29</span>, <span class="hljs-number">30</span>, <span class="hljs-number">31</span>, <span class="hljs-number">32</span>,  <span class="hljs-number">1</span>]



P = [<span class="hljs-number">16</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">29</span>, <span class="hljs-number">12</span>, <span class="hljs-number">28</span>, <span class="hljs-number">17</span>,
     <span class="hljs-number">1</span>, <span class="hljs-number">15</span>, <span class="hljs-number">23</span>, <span class="hljs-number">26</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">18</span>, <span class="hljs-number">31</span>, <span class="hljs-number">10</span>,
     <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">24</span>, <span class="hljs-number">14</span>, <span class="hljs-number">32</span>, <span class="hljs-number">27</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">9</span>,
     <span class="hljs-number">19</span>, <span class="hljs-number">13</span>, <span class="hljs-number">30</span>, <span class="hljs-number">6</span>, <span class="hljs-number">22</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">25</span>]


S =  [
 [<span class="hljs-number">14</span>, <span class="hljs-number">4</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">15</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">7</span>,
     <span class="hljs-number">0</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">8</span>,
     <span class="hljs-number">4</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">11</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">0</span>,
     <span class="hljs-number">15</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">14</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">13</span> ],



[<span class="hljs-number">15</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">10</span>,
     <span class="hljs-number">3</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">14</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">5</span>,
     <span class="hljs-number">0</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">15</span>,
     <span class="hljs-number">13</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">9</span>],


[<span class="hljs-number">10</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>,
     <span class="hljs-number">13</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">14</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">1</span>,
     <span class="hljs-number">13</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">7</span>,
     <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">12</span> ],


[<span class="hljs-number">7</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">12</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">15</span>,
     <span class="hljs-number">13</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>,<span class="hljs-number">9</span>,
     <span class="hljs-number">10</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">4</span>,
     <span class="hljs-number">3</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">14</span>],


 [<span class="hljs-number">2</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">9</span>,
     <span class="hljs-number">14</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">6</span>,
     <span class="hljs-number">4</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">14</span>,
     <span class="hljs-number">11</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">3</span>],

[<span class="hljs-number">12</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">11</span>,
     <span class="hljs-number">10</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">8</span>,
     <span class="hljs-number">9</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">6</span>,
     <span class="hljs-number">4</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">13</span>],


[<span class="hljs-number">4</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">1</span>,
     <span class="hljs-number">13</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">6</span>,
     <span class="hljs-number">1</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">14</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">6</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">2</span>,
     <span class="hljs-number">6</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">12</span>],


[<span class="hljs-number">13</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">8</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">7</span>,
     <span class="hljs-number">1</span>, <span class="hljs-number">15</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">2</span>,
     <span class="hljs-number">7</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">4</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">9</span>, <span class="hljs-number">12</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">2</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">8</span>,
     <span class="hljs-number">2</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">14</span>,  <span class="hljs-number">7</span>,  <span class="hljs-number">4</span>, <span class="hljs-number">10</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">9</span>,  <span class="hljs-number">0</span>,  <span class="hljs-number">3</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">11</span>],

]

#<span class="hljs-type">key</span>

PC_1 = [<span class="hljs-number">57</span>, <span class="hljs-number">49</span>, <span class="hljs-number">41</span>, <span class="hljs-number">33</span>, <span class="hljs-number">25</span>, <span class="hljs-number">17</span>,<span class="hljs-number">9</span>,
       <span class="hljs-number">1</span>, <span class="hljs-number">58</span>, <span class="hljs-number">50</span>, <span class="hljs-number">42</span>, <span class="hljs-number">34</span>, <span class="hljs-number">26</span>, <span class="hljs-number">18</span>,
      <span class="hljs-number">10</span>,  <span class="hljs-number">2</span>, <span class="hljs-number">59</span>, <span class="hljs-number">51</span>, <span class="hljs-number">43</span>, <span class="hljs-number">35</span>, <span class="hljs-number">27</span>,
      <span class="hljs-number">19</span>, <span class="hljs-number">11</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">60</span>, <span class="hljs-number">52</span>, <span class="hljs-number">44</span>, <span class="hljs-number">36</span>,
      <span class="hljs-number">63</span>, <span class="hljs-number">55</span>, <span class="hljs-number">47</span>, <span class="hljs-number">39</span>, <span class="hljs-number">31</span>, <span class="hljs-number">23</span>, <span class="hljs-number">15</span>,
       <span class="hljs-number">7</span>, <span class="hljs-number">62</span>, <span class="hljs-number">54</span>, <span class="hljs-number">46</span>, <span class="hljs-number">38</span>, <span class="hljs-number">30</span>, <span class="hljs-number">22</span>,
      <span class="hljs-number">14</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">61</span>, <span class="hljs-number">53</span>, <span class="hljs-number">45</span>, <span class="hljs-number">37</span>, <span class="hljs-number">29</span>,
      <span class="hljs-number">21</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">5</span>, <span class="hljs-number">28</span>, <span class="hljs-number">20</span>, <span class="hljs-number">12</span>, <span class="hljs-number">4</span>]



PC_2 = [<span class="hljs-number">14</span>, <span class="hljs-number">17</span>, <span class="hljs-number">11</span>, <span class="hljs-number">24</span>,  <span class="hljs-number">1</span>,  <span class="hljs-number">5</span>,  <span class="hljs-number">3</span>, <span class="hljs-number">28</span>,
      <span class="hljs-number">15</span>,  <span class="hljs-number">6</span>, <span class="hljs-number">21</span>, <span class="hljs-number">10</span>, <span class="hljs-number">23</span>, <span class="hljs-number">19</span>, <span class="hljs-number">12</span>,  <span class="hljs-number">4</span>,
      <span class="hljs-number">26</span>,  <span class="hljs-number">8</span>, <span class="hljs-number">16</span>,  <span class="hljs-number">7</span>, <span class="hljs-number">27</span>, <span class="hljs-number">20</span>, <span class="hljs-number">13</span>,  <span class="hljs-number">2</span>,
      <span class="hljs-number">41</span>, <span class="hljs-number">52</span>, <span class="hljs-number">31</span>, <span class="hljs-number">37</span>, <span class="hljs-number">47</span>, <span class="hljs-number">55</span>, <span class="hljs-number">30</span>, <span class="hljs-number">40</span>,
      <span class="hljs-number">51</span>, <span class="hljs-number">45</span>, <span class="hljs-number">33</span>, <span class="hljs-number">48</span>, <span class="hljs-number">44</span>, <span class="hljs-number">49</span>, <span class="hljs-number">39</span>, <span class="hljs-number">56</span>,
      <span class="hljs-number">34</span>, <span class="hljs-number">53</span>, <span class="hljs-number">46</span>, <span class="hljs-number">42</span>, <span class="hljs-number">50</span>, <span class="hljs-number">36</span>, <span class="hljs-number">29</span>, <span class="hljs-number">32</span>]


#秘钥左移的位数
SHIFT = [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>]</code></pre>

<p><strong>下面给出核心代码</strong></p>
<pre><code class="hljs undefined"><span class="hljs-keyword">from</span> DES_destruct <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">import</span> re
<span class="hljs-keyword">import</span> base64

<span class="hljs-comment">#一些替换数据在DES_destruct文件中</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write_in_file</span><span class="hljs-params">(str_mess)</span>:</span>
    <span class="hljs-keyword">try</span>:
        f = open(<span class="hljs-string">'DES.txt'</span>,<span class="hljs-string">'w'</span>,encoding=<span class="hljs-string">'utf-8'</span>)
        f.write(str_mess)
        f.close()
        print(<span class="hljs-string">"文件输出成功！"</span>)
    <span class="hljs-keyword">except</span> IOError:
        print(<span class="hljs-string">'文件加解密出错！！！'</span>)
<span class="hljs-comment">#将密文写在文件中</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_out_file</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">try</span>:
        f = open(<span class="hljs-string">'DES.txt'</span>,<span class="hljs-string">'r'</span>,encoding = <span class="hljs-string">'utf-8'</span>)
        mess = f.read()
        f.close()
        print(<span class="hljs-string">"文件读取成功！"</span>)
        <span class="hljs-keyword">return</span> mess
    <span class="hljs-keyword">except</span> IOError:
        print(<span class="hljs-string">'文件加解密出错！！！'</span>)


<span class="hljs-comment">#字符串转化为二进制</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">str2bin</span><span class="hljs-params">(message)</span>:</span>
    res = <span class="hljs-string">""</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> message:
        tmp = bin(ord(i))[<span class="hljs-number">2</span>:]
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,<span class="hljs-number">8</span>-len(tmp)):
            tmp = <span class="hljs-string">'0'</span>+ tmp   <span class="hljs-comment">#把输出的b给去掉</span>
        res += tmp
    <span class="hljs-keyword">return</span> res


<span class="hljs-comment">#二进制转化为字符串</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bin2str</span><span class="hljs-params">(bin_str)</span>:</span>
    res = <span class="hljs-string">""</span>
    tmp = re.findall(<span class="hljs-string">r'.&#123;8&#125;'</span>,bin_str)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp:
        res += chr(int(i,<span class="hljs-number">2</span>))
    <span class="hljs-keyword">return</span> res
    <span class="hljs-comment"># print("未经过编码的加密结果:"+res)</span>
    <span class="hljs-comment"># print("经过base64编码:"+str(base64.b64encode(res.encode('utf-8')),'utf-8'))</span>

<span class="hljs-comment">#初始置换ip##</span>
<span class="hljs-comment">#IP盒处理</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ip_change</span><span class="hljs-params">(bin_str)</span>:</span>
    res = <span class="hljs-string">""</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> IP_table:
        res += bin_str[i<span class="hljs-number">-1</span>]     <span class="hljs-comment">#数组下标i-1</span>
    <span class="hljs-keyword">return</span> res


<span class="hljs-comment">#IP逆盒处理</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ip_re_change</span><span class="hljs-params">(bin_str)</span>:</span>
    res = <span class="hljs-string">""</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> IP_re_table:
        res += bin_str[i<span class="hljs-number">-1</span>]
    <span class="hljs-keyword">return</span> res
<span class="hljs-comment">#循环左移操作</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">left_turn</span><span class="hljs-params">(my_str,num)</span>:</span>
    left_res = my_str[num:len(my_str)]
    left_res = my_str[<span class="hljs-number">0</span>:num]+left_res
    <span class="hljs-keyword">return</span> left_res

<span class="hljs-string">"""
64位初始密钥经过置换选择1 ( PC-1 ) 后变成 56 位，
经过循环左移和置换选择2 ( PC-2 ) 后分别得到 16 个 48 位子密钥 Ki 用做每一轮的迭代运算。
"""</span>
<span class="hljs-comment">#密钥生成##</span>
<span class="hljs-comment">#秘钥的PC-1置换</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">change_key1</span><span class="hljs-params">(my_key)</span>:</span>
    res = <span class="hljs-string">""</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> PC_1:
        res += my_key[i<span class="hljs-number">-1</span>]
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment">#秘钥的PC-2置换</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">change_key2</span><span class="hljs-params">(my_key)</span>:</span>
    res  = <span class="hljs-string">""</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> PC_2:
        res += my_key[i<span class="hljs-number">-1</span>]
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment">#F函数内容##</span>
<span class="hljs-comment">#E盒置换(扩展置换)</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">e_key</span><span class="hljs-params">(bin_str)</span>:</span>
    res = <span class="hljs-string">""</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> E:
        res += bin_str[i<span class="hljs-number">-1</span>]
    <span class="hljs-keyword">return</span> res


<span class="hljs-comment">#字符串异或操作,密钥加</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">str_xor</span><span class="hljs-params">(my_str1,my_str2)</span>:</span>
    res = <span class="hljs-string">""</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,len(my_str1)):
        xor_res = int(my_str1[i],<span class="hljs-number">10</span>)^int(my_str2[i],<span class="hljs-number">10</span>) <span class="hljs-comment">#变成10进制是转化成字符串 2进制与10进制异或结果一样，都是1,0</span>
        <span class="hljs-keyword">if</span> xor_res == <span class="hljs-number">1</span>:
            res += <span class="hljs-string">'1'</span>
        <span class="hljs-keyword">if</span> xor_res == <span class="hljs-number">0</span>:
            res += <span class="hljs-string">'0'</span>

    <span class="hljs-keyword">return</span> res




<span class="hljs-comment"># S盒过程</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">s_box</span><span class="hljs-params">(my_str)</span>:</span>
    res = <span class="hljs-string">""</span>
    c = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,len(my_str),<span class="hljs-number">6</span>):
        now_str = my_str[i:i+<span class="hljs-number">6</span>]
        row = int(now_str[<span class="hljs-number">0</span>]+now_str[<span class="hljs-number">5</span>],<span class="hljs-number">2</span>)
        col = int(now_str[<span class="hljs-number">1</span>:<span class="hljs-number">5</span>],<span class="hljs-number">2</span>)
        num = bin(S[c][row*<span class="hljs-number">16</span> + col])[<span class="hljs-number">2</span>:]   <span class="hljs-comment">#利用了bin输出有可能不是4位str类型的值，所以才有下面的循环并且加上字符0</span>
        <span class="hljs-keyword">for</span> gz <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,<span class="hljs-number">4</span>-len(num)):
            num = <span class="hljs-string">'0'</span>+ num
        res += num
        c  += <span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> res


<span class="hljs-comment">#P盒置换</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">p_box</span><span class="hljs-params">(bin_str)</span>:</span>
    res = <span class="hljs-string">""</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span>  P:
        res += bin_str[i<span class="hljs-number">-1</span>]
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment">#调用四种 E盒 密钥加 S盒 P盒</span>

<span class="hljs-comment"># F函数的实现</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fun_f</span><span class="hljs-params">(bin_str,key)</span>:</span>
    first_output = e_key(bin_str)
    second_output = str_xor(first_output,key)
    third_output = s_box(second_output)
    last_output = p_box(third_output)
    <span class="hljs-keyword">return</span> last_output

<span class="hljs-comment">#64位初始密钥经过置换选择1 ( PC-1 ) 后变成 56 位，</span>
<span class="hljs-comment">#经过循环左移和置换选择2 ( PC-2 ) 后分别得到 16 个 48 位子密钥 Ki 用做每一轮的迭代运算。</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">gen_key</span><span class="hljs-params">(key)</span>:</span>
    key_list = []
    divide_output = change_key1(key)<span class="hljs-comment">#pc1</span>
    key_C0 = divide_output[<span class="hljs-number">0</span>:<span class="hljs-number">28</span>]
    key_D0 = divide_output[<span class="hljs-number">28</span>:]
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> SHIFT:<span class="hljs-comment">#16轮</span>
        key_c = left_turn(key_C0,i)<span class="hljs-comment">#循环左移</span>
        key_d = left_turn(key_D0,i)
        key_output = change_key2(key_c + key_d)
        key_list.append(key_output)
    <span class="hljs-keyword">return</span> key_list





<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">des_encrypt_one</span><span class="hljs-params">(bin_message,bin_key)</span>:</span> <span class="hljs-comment">#64位二进制加密的测试</span>
    <span class="hljs-comment">#bin_message = deal_mess(str2bin(message))</span>
    mes_ip_bin = ip_change(bin_message)<span class="hljs-comment">#ip置换</span>
    <span class="hljs-comment">#bin_key = input_key_judge(str2bin(key))</span>
    key_lst = gen_key(bin_key)<span class="hljs-comment">#生成密钥</span>
    mes_left = mes_ip_bin[<span class="hljs-number">0</span>:<span class="hljs-number">32</span>]<span class="hljs-comment">#l0</span>
    mes_right = mes_ip_bin[<span class="hljs-number">32</span>:]<span class="hljs-comment">#p0</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,<span class="hljs-number">15</span>):
        mes_tmp = mes_right
        f_result = fun_f(mes_tmp,key_lst[i])
        mes_right = str_xor(f_result,mes_left)
        mes_left = mes_tmp
    f_result = fun_f(mes_right,key_lst[<span class="hljs-number">15</span>])<span class="hljs-comment">#最后一轮 单独写</span>
    mes_fin_left = str_xor(mes_left,f_result)
    mes_fin_right = mes_right
    fin_message = ip_re_change(mes_fin_left + mes_fin_right)
    <span class="hljs-keyword">return</span> fin_message

<span class="hljs-comment">##64位二进制解密的测试,注意秘钥反过来了，不要写错了</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">des_decrypt_one</span><span class="hljs-params">(bin_mess,bin_key)</span>:</span>
    mes_ip_bin = ip_change(bin_mess)
    <span class="hljs-comment">#bin_key = input_key_judge(str2bin(key))</span>
    key_lst = gen_key(bin_key)
    lst = range(<span class="hljs-number">1</span>,<span class="hljs-number">16</span>)
    cipher_left = mes_ip_bin[<span class="hljs-number">0</span>:<span class="hljs-number">32</span>]
    cipher_right = mes_ip_bin[<span class="hljs-number">32</span>:]
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lst[::<span class="hljs-number">-1</span>]:
        mes_tmp = cipher_right
        cipher_right = str_xor(cipher_left,fun_f(cipher_right,key_lst[i]))
        cipher_left = mes_tmp
    fin_left = str_xor(cipher_left,fun_f(cipher_right,key_lst[<span class="hljs-number">0</span>]))
    fin_right = cipher_right
    fin_output  = fin_left + fin_right
    bin_plain = ip_re_change(fin_output)
    res = bin2str(bin_plain)

    <span class="hljs-keyword">return</span> res


<span class="hljs-comment">#简单判断以及处理信息分组</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">deal_mess</span><span class="hljs-params">(bin_mess)</span>:</span>
    <span class="hljs-string">"""  
    :param bin_mess: 二进制的信息流
    :return: 补充的64位信息流
    """</span>
    ans = len(bin_mess)
    <span class="hljs-keyword">if</span> ans % <span class="hljs-number">64</span> != <span class="hljs-number">0</span>:
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range( <span class="hljs-number">64</span> - (ans%<span class="hljs-number">64</span>)):           <span class="hljs-comment">#不够64位补充0</span>
            bin_mess += <span class="hljs-string">'0'</span>
    <span class="hljs-keyword">return</span> bin_mess


<span class="hljs-comment">#查看秘钥是否为64位</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">input_key_judge</span><span class="hljs-params">(bin_key)</span>:</span>
    <span class="hljs-string">"""
    全部秘钥以补0的方式实现长度不满足64位的
    :param bin_key: 
    """</span>
    ans = len(bin_key)
    <span class="hljs-keyword">if</span> len(bin_key) &lt; <span class="hljs-number">64</span>:
        <span class="hljs-keyword">if</span> ans % <span class="hljs-number">64</span> != <span class="hljs-number">0</span>:
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">64</span> - (ans % <span class="hljs-number">64</span>)):  <span class="hljs-comment"># 不够64位补充0</span>
                bin_key += <span class="hljs-string">'0'</span>
    <span class="hljs-comment"># else:</span>
    <span class="hljs-comment">#     bin_key = bin_key[0:64]    #秘钥超过64位的情况默认就是应该跟密文一样长 直接将密钥变为跟明文一样的长度，虽然安全性会有所下降</span>
    <span class="hljs-keyword">return</span> bin_key
<span class="hljs-string">"""def cbc_desenc(mes,key):
    IV="aaaaaaaa"
    res=""
    i=0
    cns=""
    while mes[i:i+8]!="":
        if i==0:
            res+=DESenc_test(bintostr(xor(strtobin(IV),strtobin(mes[i:i+8]))),key)
            cns=DESenc_test(bintostr(xor(strtobin(IV),strtobin(mes[i:i+8]))),key)
        else:
            res+=DESenc_test(bintostr(xor(cns,strtobin(mes[i:i+8]))),key)
            cns=DESenc_test(bintostr(xor(cns,strtobin(mes[i:i+8]))),key)
        i=i+8
    return res"""</span>
<span class="hljs-comment">#cbc模式下解密</span>
<span class="hljs-string">"""def cbc_desdec(cipher,key):
    res=""
    IV="aaaaaaaa"
    i=0
    cns=""
    while cipher[i:i+64]!="":
        if i==0:
            res+=bintostr(xor(strtobin(DESdec_test(cipher[i:i+64],key)),strtobin(IV)))
            cns=cipher[i:i+64]
        else:
            res+=bintostr(xor(strtobin(DESdec_test(cipher[i:i+64],key)),cns))
            cns=cipher[i:i+64]
        i=i+64
    return res"""</span>



<span class="hljs-comment">#分组长度为64位</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">all_message_encrypt</span><span class="hljs-params">(message,key)</span>:</span>

    
    bin_mess = deal_mess(str2bin(message))
    res = <span class="hljs-string">""</span>
    bin_key = input_key_judge(str2bin(key))
    tmp = re.findall(<span class="hljs-string">r'.&#123;64&#125;'</span>,bin_mess)<span class="hljs-comment">#正则表达式，把所有64位分开来</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp:
        res += des_encrypt_one(i,bin_key)
       
    <span class="hljs-keyword">return</span> res
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cbc_all_message_encrypt</span><span class="hljs-params">(message,key)</span>:</span>

    IV=<span class="hljs-string">"aaaaaaaa"</span>
    bin_mess = deal_mess(str2bin(message))
    res = <span class="hljs-string">""</span>
    cns = <span class="hljs-string">""</span>
    bin_key = input_key_judge(str2bin(key))
    tmp = re.findall(<span class="hljs-string">r'.&#123;64&#125;'</span>,bin_mess)<span class="hljs-comment">#正则表达式，把所有64位分开来</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp:
        <span class="hljs-keyword">if</span>(i==tmp[<span class="hljs-number">0</span>]):
            res += des_encrypt_one(str_xor(i,str2bin(IV)),bin_key)
            cns = des_encrypt_one(str_xor(i,str2bin(IV)),bin_key)
        <span class="hljs-keyword">else</span>:
            res += des_encrypt_one(str_xor(i,cns),bin_key)
            cns = des_encrypt_one(str_xor(i,cns),bin_key)
    <span class="hljs-keyword">return</span> res
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cbc_all_message_decrypt</span><span class="hljs-params">(message,key)</span>:</span>
    IV=<span class="hljs-string">"aaaaaaaa"</span>
    bin_mess = deal_mess(str2bin(message))
    res = <span class="hljs-string">""</span>
    cns=<span class="hljs-string">""</span>
    bin_key = input_key_judge(str2bin(key))
    tmp = re.findall(<span class="hljs-string">r'.&#123;64&#125;'</span>,bin_mess)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp:
        <span class="hljs-keyword">if</span>(i==tmp[<span class="hljs-number">0</span>]):
            res += str_xor(str2bin(des_decrypt_one(i,bin_key)),str2bin(IV))
            cns=i
        <span class="hljs-keyword">else</span>:
            res +=str_xor(str2bin(des_decrypt_one(i,bin_key)),cns)
            cns=i

    <span class="hljs-keyword">return</span> bin2str(res)


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">all_message_decrypt</span><span class="hljs-params">(message,key)</span>:</span>
    bin_mess = deal_mess(str2bin(message))
    res = <span class="hljs-string">""</span>
    bin_key = input_key_judge(str2bin(key))
    tmp = re.findall(<span class="hljs-string">r'.&#123;64&#125;'</span>,bin_mess)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp:
        res += des_decrypt_one(i,bin_key)

    <span class="hljs-keyword">return</span> res



<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_mode</span><span class="hljs-params">()</span>:</span>

    print(<span class="hljs-string">"1.加密"</span>)
    print(<span class="hljs-string">"2.解密"</span>)
    print(<span class="hljs-string">"3.CBC模式加密"</span>)
    print(<span class="hljs-string">"4.CBC模式解密"</span>)
    mode = input()
    <span class="hljs-keyword">if</span> mode == <span class="hljs-string">'1'</span>:
        print(<span class="hljs-string">"请输入信息输入字符串不能为空："</span>)
        message = input().replace(<span class="hljs-string">' '</span>,<span class="hljs-string">''</span>)
        print(<span class="hljs-string">"请输入你的秘钥："</span>)
        key = input().replace(<span class="hljs-string">' '</span>,<span class="hljs-string">''</span>)
        s = all_message_encrypt(message,key)
        out_mess = bin2str(s)
        print(<span class="hljs-string">"加密过后的内容:"</span>+ out_mess)
        write_in_file(out_mess)
        <span class="hljs-comment">#print(type(out_mess))</span>
        <span class="hljs-comment"># base_out_mess = base64.b64encode(out_mess.encode('utf-8'))</span>
        <span class="hljs-comment"># print("Base64编码过后:"+ base_out_mess.decode())</span>
    <span class="hljs-keyword">elif</span> mode == <span class="hljs-string">'2'</span>:
        <span class="hljs-comment"># print("请输入信息输入字符串不能为空：")</span>
        <span class="hljs-comment"># message = input().replace(' ', '')</span>
        print(<span class="hljs-string">"请输入你的秘钥："</span>)
        key = input().replace(<span class="hljs-string">' '</span>, <span class="hljs-string">''</span>)
        message = read_out_file()
        s = all_message_decrypt(message, key)
        <span class="hljs-comment">#out_mess = bin2str(s)</span>
        print(<span class="hljs-string">"解密后的信息："</span>+ s)
    <span class="hljs-keyword">elif</span> mode == <span class="hljs-string">'3'</span>:
        print(<span class="hljs-string">"请输入信息输入字符串不能为空："</span>)
        message = input().replace(<span class="hljs-string">' '</span>,<span class="hljs-string">''</span>)
        print(<span class="hljs-string">"请输入你的秘钥："</span>)
        key = input().replace(<span class="hljs-string">' '</span>,<span class="hljs-string">''</span>)
        s = cbc_all_message_encrypt(message,key)
        out_mess = bin2str(s)
        print(<span class="hljs-string">"通过CBC加密过后的内容:"</span>+ out_mess)
        write_in_file(out_mess)
    <span class="hljs-keyword">elif</span> mode== <span class="hljs-string">'4'</span>:
        print(<span class="hljs-string">"请输入你的秘钥："</span>)
        key = input().replace(<span class="hljs-string">' '</span>, <span class="hljs-string">''</span>)
        message = read_out_file()
        s = cbc_all_message_decrypt(message, key)
        <span class="hljs-comment">#out_mess = bin2str(s)</span>
        print(<span class="hljs-string">"通过CBC解密后的信息："</span>+ s)
    <span class="hljs-keyword">else</span>:
        print(<span class="hljs-string">"请重新输入！"</span>)
    


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        get_mode()</code></pre>
        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Theme By <a target="_blank" href="https://github.com/levblanc">Levblanc.</a>
          Inspired By <a target="_blank" href="https://github.com/klugjo/hexo-theme-clean-blog">Clean Blog.</a>
        <p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/disshu.github.io/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

